<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ö–æ—Ä–º–ª–µ–Ω–∏–µ –∫–æ—Ç–∞</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script defer src="app.js"></script>

<style>
  body {
    font-family: sans-serif;
    max-width: 520px;
    margin: 0 auto;
    padding: 22px;
    background: #fff;
  }

  h1 { margin: 0 0 10px; }
  h2 { margin: 10px 0 10px; font-weight: 700; }

  .small-link {
    display: inline-block;
    margin-top: 8px;
    font-size: 14px;
    opacity: .65;
    cursor: pointer;
    user-select: none;
  }

  input {
    width: 100%;
    box-sizing: border-box;
    padding: 10px;
    margin: 6px 0;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 15px;
  }

  button {
    width: 100%;
    box-sizing: border-box;
    padding: 12px 10px;
    margin: 8px 0;
    border-radius: 7px;
    border: 1px solid #bdbdbd;
    background: #f3f3f3;
    font-size: 15px;
    cursor: pointer;
  }

  .row {
    display: flex;
    gap: 10px;
  }

  .row button {
    flex: 1;
    margin: 8px 0;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin: 14px 0 8px;
  }

  td {
    padding: 10px 6px;
    border-bottom: 1px solid #e0e0e0;
    vertical-align: middle;
  }

  .label { color: #666; width: 45%; }
  .value { text-align: left; font-weight: 600; }

  .red { color: #d32f2f; font-weight: 700; }

  /* select –∫–∞–∫ ‚Äú—Ç–µ–∫—Å—Ç‚Äù, –Ω–æ —Å–æ —Å—Ç—Ä–µ–ª–∫–æ–π */
  .cat-select {
    appearance: none;
    -webkit-appearance: none;
    border: 0;
    background: transparent;
    font: inherit;
    font-weight: 600;
    padding-right: 18px;
    cursor: pointer;
    outline: none;
  }
  .select-wrap {
    position: relative;
    display: inline-block;
    max-width: 100%;
  }
  .select-wrap:after {
    content: "‚ñæ";
    position: absolute;
    right: 0;
    top: 0;
    color: #777;
    pointer-events: none;
  }

  /* warning */
  #fatWarning {
    margin: 8px 0 6px;
  }

  /* Modals */
  .modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.35);
    align-items: center;
    justify-content: center;
    padding: 18px;
    opacity: 0;
    transition: opacity .18s ease;
  }
  .modal.show {
    display: flex;
    opacity: 1;
  }
  .modal-content {
    width: 100%;
    max-width: 420px;
    background: #fff;
    border-radius: 10px;
    border: 1px solid #ddd;
    padding: 16px 16px 12px;
    transform: translateY(14px);
    transition: transform .18s ease;
  }
  .modal.show .modal-content { transform: translateY(0); }

  .modal h3 { margin: 0 0 10px; }
  .modal .row { margin-top: 8px; }
  .modal .danger { background: #fff; border-color: #d32f2f; color: #d32f2f; }

  /* History table */
  .history-table td { border-bottom: 1px solid #eee; padding: 8px 6px; }
  .muted { opacity: .75; font-weight: 500; }
</style>
</head>

<body>

<h1>üê± –ö–æ—Ä–º–ª–µ–Ω–∏–µ –∫–æ—Ç–∞</h1>

<!-- AUTH -->
<div id="auth">
  <h2>–í—Ö–æ–¥</h2>
  <input id="username" placeholder="Email –∏–ª–∏ username" autocomplete="username" />
  <input id="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å" autocomplete="current-password" />
  <button id="loginBtn">–í–æ–π—Ç–∏</button>
  <div id="forgotBtn" class="small-link">–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</div>
</div>

<!-- APP -->
<div id="app" style="display:none;">
  <h2>–ü—Ä–∏–≤–µ—Ç, <span id="who"></span> üëã</h2>

  <div id="fatWarning" class="red" style="display:none;">
    –û—Å—Ç–æ—Ä–æ–∂–Ω–æ, —ç—Ç–æ –ø—É—Ç—å –∫ –∂–∏—Ä–Ω–æ–º—É –∫–æ—Ç—É üòº
  </div>

  <table id="catTable"></table>

  <div class="row">
    <button id="addDryBtn">ü•£ –°—É—Ö–æ–π</button>
    <button id="addWetBtn">ü•´ –í–ª–∞–∂–Ω—ã–π</button>
  </div>

  <button id="historyBtn">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>

  <div class="row">
    <button id="editCatBtn">‚úè –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
    <button id="addCatBtn">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–æ—Ç–∞</button>
  </div>

  <button id="logoutBtn">–í—ã–π—Ç–∏</button>
</div>

<!-- CAT MODAL -->
<div id="catModal" class="modal">
  <div class="modal-content">
    <h3 id="catModalTitle">–ö–æ—Ç</h3>
    <input id="catNameInput" placeholder="–ò–º—è –∫–æ—Ç–∞" />
    <input id="catDryInput" type="number" inputmode="numeric" placeholder="–°—É—Ç–æ—á–Ω–∞—è –Ω–æ—Ä–º–∞ —Å—É—Ö–æ–≥–æ (–≥)" />
    <input id="catWetInput" type="number" inputmode="numeric" placeholder="–°—É—Ç–æ—á–Ω–∞—è –Ω–æ—Ä–º–∞ –≤–ª–∞–∂–Ω–æ–≥–æ (–≥)" />
    <button id="saveCatBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    <button id="deleteCatBtn" class="danger" style="display:none;">–£–¥–∞–ª–∏—Ç—å –∫–æ—Ç–∞</button>
    <button id="cancelCatBtn">–û—Ç–º–µ–Ω–∞</button>
  </div>
</div>

<!-- FOOD MODAL -->
<div id="foodModal" class="modal">
  <div class="modal-content">
    <h3 id="foodModalTitle">–î–æ–±–∞–≤–∏—Ç—å –∫–æ—Ä–º</h3>
    <input id="foodGramsInput" type="number" inputmode="numeric" placeholder="–ì—Ä–∞–º–º—ã" />
    <button id="saveFoodBtn">–î–æ–±–∞–≤–∏—Ç—å</button>
    <button id="cancelFoodBtn">–û—Ç–º–µ–Ω–∞</button>
  </div>
</div>

<!-- HISTORY MODAL -->
<div id="historyModal" class="modal">
  <div class="modal-content">
    <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ 6 –º–µ—Å—è—Ü–µ–≤</h3>
    <div id="historyContent" class="muted">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</div>
    <button id="closeHistoryBtn">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
</div>

<!-- RESET PASSWORD MODAL -->
<div id="resetModal" class="modal">
  <div class="modal-content">
    <h3>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</h3>
    <input id="newPasswordInput" type="password" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å" autocomplete="new-password" />
    <input id="confirmPasswordInput" type="password" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" autocomplete="new-password" />
    <button id="savePasswordBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
  </div>
</div>

</body>
</html>
